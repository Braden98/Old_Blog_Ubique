---
layout:     post
title:      "代码整洁之道"
subtitle:   " 不能铭记过去的人，注定要重蹈覆辙。"
date:       2019-05-02 12:00:00
author:     "Ubik"
header-img: "img/post-bg-2015.jpg"
catalog: true
comments: true
tags:
    - Summary
    - Clean Code
---



> 享受职业素养。

# 专业主义
## 不行损害之事
- 让 QA 找不出任何问题

- 确信代码能正常运行（通过主动反复测试）
- 自动化 QA
- 不要破坏结构，以牺牲结构为代价发布新功能，得不偿失，将来必定后悔。

##了解所在领域
- NS图表
 
- Mealy & Moore 状态机的差别
- 变换分析的含义
- 快速排序手写
- 临时传递数据
- 耦合性（Conascence）

## 每个开发人员必须精通的事项
- 设计模式 （GOF，24）
- 设计原则（SOLID）

- 编程方法
    - XP
    - Scrum
    - 精益
    - 看板
    - 瀑布
    - 结构化分析、设计
- 实践
    - 测试驱动开发
    - 面向对象设计
    - 结构化编程
    - 持续集成
    - 结对编程
- 工件
    - UML 图
    - DFD 图
    - 结构图
    - Petri 网络图
    - 状态迁移图标
    - 流程图
    - 决策表
    - 甘特图
## 职业道德
- 坚持学习
- 练习
- 合作

- 辅导
- 了解业务领域
- 与客户（需求）保持一致
- 谦逊

# 说“不”
- 当你面对类似猩猩卖场提出的在黑色星期五之前做出一个 iPhone 应用的需求时，你应该尊重事实和自己，敢于说“不”。

# 说“是”
## 承诺用语
做出承诺包含三个步骤
- **口头上说**自己将会去做

- **心里认真对待**做出的承诺
- 真正**付诸行动**

## 逃避用语
- 需要/应该
    - 我们需要把这事做完
    - 但愿我有时间做这事
- 希望/但愿
    - 希望我明天能完成任务
    - 但愿电脑能快点
- 让我们（而不是让我）
    - 让我们回头见
    - 让我们把这事做完
总之，说“是”就是：你对自己将会做某事做了清晰的事实陈述，而且还说明了完成期限。

# 编码
## 代码要求
- 代码能正常工作

- 代码能满足需求
- 代码能和现有系统结合得天衣无缝
- 其他程序员能读懂你的代码

## 个人状态
- 凌晨三点写的可能是糟糕的代码
- 焦虑时也是如此

- 流态区可能会效率高，但也会导致**忽略与全局整合**
- 音乐并不能提高效率
- 被打断的预防是结对编程或者 TDD
- 阻塞时找点别的事情干
- “创造性输出”依赖于“创造性输入”，比如音乐、小说、电影等
- 调试也是编码的一部分

## 保持节奏
软件开发是一场马拉松🏃🏻‍♂️而不是短跑。
- 知道何时应该离开一会，疲倦、预防颈椎病、心血管疾病（......)

- 开车回家路上，脑袋可以解决一些问题
- 洗澡同上
- 进度延迟时坚决坚持你的估算
- 加班长期来说并无好处

## 帮助
- 帮助他人可以收获更多

- 接受他人帮助
- 辅导缺乏经验的程序员是老鸟的职责

# 测试驱动开发
最早是 XP 极限编程运动的一部分，后被其他所有敏捷方法采纳。不仅是一种缩短编码周期的简单技巧。
## 三项法则是
1. 编写好失败单元测试之前，不写任何产品代码

2. 只要有一个单元测试失败，就不再写测试代码；无法通过编译也是一种失败
3. 产品代码恰好能够让当前的失败单元测试通过即可，不必多写

## 优势
- 确定性 修改之后运行测试，确保没有错误因修改产生

- 减少 Bug

- 让人敢于修改代码

- 单元测试成为示例和文档
- 遵循三项法则有助于做出松耦合的设计，因为测试不允许耦合
- 专业人士的选择

## 局限
- 某些情况下确实不适用，并非银弹，就像 DDD。

# 练习
- 用自己的时间练习————保证不落伍是自己的责任

-专业人士需要练习，做到最好，拓宽视野。

# 验收测试
- 不要过早精细化————你不知道哪儿应该精细化
- 但确定需求应该尽早

- 业务分析员测试“正确路径”，QA测试“错误路径”
- 验收测试是业务方写给业务方的，单元测试是程序员写给自己的（也可以拿来做文档的一部分）

# 测试策略
- QA 的任务就是和业务人员一起创建自动化验收测试。

- 自动化测试金字塔，自顶向下依次是
    - 人工探索式测试：需要人工介入，既不是自动化测试，也非脚本测试，目的是探索系统预期之外的能力
    
    - 系统测试：对整个集成完毕的系统的自动化测试，不会直接测试业务规则，而是测试系统是否已经正确组装完毕、各部件之间是否能正常交互。
    - 集成测试：组装配件成组合，判断其是否正常通信，是编排型测试，只看是否协调，不管业务规则
    - 组件测试：对组建的业务规则的验收测试
    - 单元测试：供程序员自己使用

# 时间管理
8小时很短暂，只有480分钟，28800秒。
- 会议需要成本，时间成本和金钱成本

- 会议并不总要参加，也可以离席
- 敏捷开发会议需要回答三个问题，每个问题不超过 20s
    - 我昨天干了什么
    - 我今天打算干什么
    - 我遇到了什么问题
- 注意力
    - 足够的睡眠
    - 不集中注意力时，注意力可以恢复
    - 肌肉注意力不同于心智注意力，且前者可以改善后者
    - 平衡输入与输出
- 要避免的行为
    - 优先级错乱
    - 死胡同（走不下去，应该折返）
    - 泥潭（可以完成但效率严重降低，应及时抽身）

# 预估
不同的人对预估看法不同。业务方觉得预估就是承诺，开发方认为认为预估只是个猜测。
- 避免暗示性承诺，分清楚预估与承诺

- 计划评审技术（PERT）
    - 乐观预估 O
    - 标称预估 N
    - 悲观预估 P
    - 期望时间 u = (O+4N+P)/6
    - 标准差 o = (P-O)/6
    - 
- 生成共识的 Delphi 法
    - 亮手指
    - 规划扑克
    - 关联预估
    - 三元预估
- 大数定律防止预估出错

# 压力
- 避免压力
    - 合理的承诺
    - 保持整洁
    - 危机中的纪律

- 应对压力
    - 不要惊慌失措
    - 沟通
    - 依靠纪律原则
    - 寻求帮助
  
# 协作
> 我们并非是因为喜欢和其他人在一起工作而选择做程序员的

- 与用户讨论，理解业务

- 与程序员密切合作
    - 共享代码
    - 结对编程
  
# 项目与团队
> 项目比团队更难构建

- 让一个程序员同时投身两个项目并不明智

- 有凝聚力的团队可以有3-20人，最好是12人。

# 辅导、学徒期与技艺
> 医学专业已经建立了一套严密的辅导体系。

- 上升过程
    - 学徒期/实习生
    - 熟练工
    - 大师
学校能够传授的是理论，无法传授作为一个程序员所需掌握的原则、实践和技能。这些东西只有经由师徒个体间多年的细心监督和辅导才能获得。每个程序员都会经历上述时期，因此应该建立一种包含学徒期、实习期和长期指引的机制。